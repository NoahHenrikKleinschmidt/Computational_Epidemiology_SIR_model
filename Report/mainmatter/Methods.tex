\section{The SIR Model}

\subsection{Susceptible Population $S$}
This project assumes the total population $S$ consists of two groups as per:
	

$$
S = S_n + S_h = \alpha_n  \cdot S + \alpha_h \cdot S
$$

where $\alpha_i$ are the percentages of each sub-group within the population, $\alpha_n + \alpha_h = 1$. 

\subsection{Infectious Population $I$}
As both $S_n$ and $S_h$ are assumed to have different susceptibilities, they are assigned two different rates of infection: $\beta_n$ and $\beta_h$, where we assume for simplicity sake (see Introduction) that $\beta_h = k\cdot\beta_n$ for some $k \in \mathbb{R}$. Given the scalar relation between $\beta_n$ and $\beta_h$ we abbreviate $\beta_n \equiv \beta$, as we will do for any transition rate henceforth.


\subsection{Removed Population $R$}
The removed population $R$ consists of two sub-populations, namely the recovered population $R'$ and the deceased population $D$. Infectious individuals may transition into either $R'$ or $D$, given two separate transition rates. 

We define the recovery rate $\gamma$ and death rate $\theta$ whose scaled rates for the "highly" susceptibles are $\gamma_h = j\cdot\gamma$ and $\theta_h = q \cdot \theta$ for some $j, q \in \mathbb{R}$, respectively.

We further define a relapsation rate $\delta$ that mimics how immunity is lost over time (perhaps due to newly emerging mutant pathogens) and allows individuals from $R'$ to relapse into $S$. Here as well "highly" susceptibles are linearly scaled as $\delta_h = h \cdot \delta$ for some $h \in \mathbb{R}$. 

\subsection{System of Equations}

The outlined model allows transitions between Susceptible $S$ to Infectious $I$, from $I$ to either Removed population $R'$ or $D$, and from $R'$ back to $S$. This allows the following set of first order differential equations to be formulated:

\begin{aligned}
$$
\frac{dS(t)}{dt} &=  -\beta \Phi_k \cdot S(t) \cdot I(t) + \delta\Phi_h \cdot R'(t) 
$$ \\
$$
\frac{dI(t)}{dt} &=  \beta \Phi_k \cdot S(t) \cdot I(t) - \gamma\Phi_j \cdot I(t) - \theta\Phi_q\cdot I(t) 
$$ \\
$$
\frac{dR'(t)}{dt} &=  \gamma\Phi_j \cdot I(t) - \delta\Phi_h \cdot R'(t)
$$ \\
$$
\frac{dD(t)}{dt} &=  \theta\Phi_q\cdot I(t) 
$$
\end{aligned}
\vspace{10pt}

Where $\Phi_x = \alpha_n + x\cdot \alpha_h$ describes the impact of "highly" susceptibles within the total population for some scalar factor $x$ of a given transition. 
\\

This set of differential equations now has four separate rates of transition: (1) $\beta$, the rate of infection, where "highly" susceptibles are distinguished by a $k$-fold increase/ decrease. (2) $\gamma$, the rate of recovery, where "highly" susceptibles are distinguished by a $j$-fold increase/decrease. (3) $\delta$, the relapsation rate, where "highly" susceptibles are distinguished by an $h$-fold increase/drecrease. And (4) $\theta$, the death rate, where "highly" susceptibles are distinguished by a $q$-fold increase/decrease compared to "normally" susceptibles. All of these are editable to explore different scenarios of heterogeneous populations. 



% NOTE: Most of this stuff was kinda re-written and is NO LONGER 100% valid!!! It's just here for reference sake in case some detail may be needed...
%
%Removed (recovered or deceased) cannot be infected nor infect others. Both $S_n$ and $S_h$ have a recovery rate that assigns them to this population. Yet, we assume that the two groups have different rates of recovery $\gamma_n$ and $\gamma_h$. We again assume for simplicity sake that $\gamma_h = j\cdot\gamma_n$ for some $j < 1 \in \mathbb{R}$. The total rate at which $R$ increases is hence $\gamma_n + \gamma_h = \gamma_n + j\gamma_n = (1+j)\gamma_n$.
%
%\subsection{Preliminary SIR System of Equations}
%As both infection rate and recovery rate are ultimately just determined by the rate for the "normally" susceptibles we abbreviate $\beta_n \equiv \beta$ and $\gamma_n \equiv \gamma$.
%
%The implemented system of differential equations is hence: 
%
%$$
%\begin{align}
%
%\frac{dS(t)}{dt} = {}&  [\ -\beta \cdot S_n(t) - k\beta \cdot S_h(t) \ ] \cdot I(t) \\
%\frac{dI(t)}{dt} = {}&  [\ \beta \cdot S_n(t) + k\beta \cdot S_h(t) \ ] \cdot I(t) - (1 + j)\gamma\cdot I(t) \\
%\frac{dR(t)}{dt} = {}&  (1 + j)\gamma\cdot I(t)
%
%\end{align}
%$$
%
%
%This system we can simplify slightly by aggregating the infectous transition for $S_n$ and $S_h$ as follows, thus modifying $\frac{dS(t)}{dt}$ and $\frac{dI(t)}{dt}$:
%
%$$
%\begin{align}
%
%\frac{dS(t)}{dt} = {}&  -\beta(\alpha_n  + k (1 -\alpha_n)) \cdot S(t)\cdot I(t) \\
%\frac{dI(t)}{dt} = {}&  \beta(\alpha_n  + k (1 -\alpha_n)) \cdot S(t)\cdot I(t) - (1 + j)\gamma\cdot I(t) \\
%
%\end{align}
%$$
%

%\begin{align*}
%
%$\frac{dS(t)}{dt} &=  -\beta(\alpha_n  + k (1 -\alpha_n)) \cdot S(t) \cdot I(t) + \delta(1 + h) \cdot R(t)$ \\
%
%$\frac{dI(t)}{dt} &=  \beta(\alpha_n  + k (1 -\alpha_n)) \cdot S(t) \cdot I(t) - (1 + j)\gamma\cdot I(t)$ \\
%
%$\frac{dR(t)}{dt} &=  (1 + j)\gamma\cdot I(t) - \delta(1 + h) \cdot R(t)$
%
%
%\end{align*}
%
%\subsection{Relapsation of susceptibles}
%In our preliminary model we assume two groups within the population, the "normal" and "highly" susceptibles. We further assume that, although they both have different rates of infection and recovery, they ultimately endure the same course of disease, going from susceptible, to infectous, and ultimately to removed. However, what if this assumption were not true, and a small part of the population were to relapse into the susceptible population $S$ after having endured the infectuous stage? 
%
%This could be the case for immuno-suppressed inviduals who did survive the disease due to medical care but were unable to fully develop their own immune response. Alternatively, normally susceptibles may have endured a more severe course of disease that weakened their immune system, thus pushing them to the highly susceptibles after having left the infectuous stage. 
%
%\subsubsection{Relapsation Rate $\delta$}
%Both of the above scenarious are somewhat complex, and shall be addressed in a simplified manner by introducing a relapsation rate $\delta_i$ for both normally and highly susceptibles. $\delta_i$ allows removed people to leave $R$ to re-enter $S$ as part of the highly susceptibles $S_h$. Thereby, $\frac{dS(t)}{dt}$ will be modified to receive an additive term from $R$, and $\frac{dR(t)}{dt}$ will receive a corresponding subtractive term. As we assume normal and highly susceptibles will have different rates of relapsation, we will use our default asumption of $\delta_h = h \cdot \delta_n$ for some $h \in \R$ (no restriction to bigger or smaller 1).
%
%\subsection{Relapsation SIR System of Equations}
%We retain $\beta_n \equiv \beta$ and $\gamma_n \equiv \gamma$, and abbreviate $\delta_n \equiv \delta$.
%The implemented system of differential equations is hence: 
%
%$$
%\begin{align}
%
%\frac{dS(t)}{dt} = {}&  -\beta(\alpha_n  + k (1 -\alpha_n)) \cdot S(t) \cdot I(t) + \delta(1 + h) \cdot R(t) \\
%\frac{dI(t)}{dt} = {}&  \beta(\alpha_n  + k (1 -\alpha_n)) \cdot S(t) \cdot I(t) - (1 + j)\gamma\cdot I(t) \\
%
%\frac{dR(t)}{dt} = {}&  (1 + j)\gamma\cdot I(t) - \delta(1 + h) \cdot R(t)
%
%\end{align}
%$$
%
%
%\subsection{Lethality versus Recovery}
%The model outlined so far has treated recovered and deceased as equivalent. However, considering the assumtion above of some more susceptible groups that may also have a higher relapsation rate, the concept of lethality should be taken into consideration as well. Immuno-suppressed individuals may very likely have a higher risk of actually dying rather than recovering. This would impact the subtractive term of $\frac{dI(t)}{dt}$ (additive in $\frac{dR(t)}{dt}$), as only a sub-group of removed may be able to relapse, namely the ones who survived. To address this we modify the model to split the current $R$ into two groups $R'$ (recovered, who may relapse) and $D$ (deceased, who may not relapse). Admitedly, this does leave the \textit{SIR} model for an "\textit{SIRD}" model (not sure about terminlolgy?), but seems to mimic disease dynamics better under the given assumptive parameters. 
%
%\subsubsection{Death rate $\theta$}
%To split the current $R$ (removed) we adjust the rate of transition from $I$ to $R$ for the two new subgroups of $R$, we introduce a lethality rate $\theta$ as a percentage of people who transition to $R$ due to death rather than recovery. $\theta$ modifies the current recovery rate $\gamma$ to a new recovery rate $\gamma' = (1 - \theta)\gamma$. 
%We again assume that highly susceptibles have a different death rate than normally susceptibles: $\theta_h = q \cdot \theta_n$ for some $q > 1 \in \R$. 
%
%
%The new transition from $I$ to $R'$ or $D$ is hence: 
%
%$$
%\begin{aligned}
%\frac{dI(t)}{dt} = {}&  \beta(\alpha_n  + k (1 -\alpha_n)) \cdot S(t) \cdot I(t) - (1 + j)\gamma'\cdot I(t) - (1 + q)\theta\cdot I(t) \\
%
%\frac{dR'(t)}{dt} = {}&  (1 + j)\gamma'\cdot I(t) - \delta(1 + h) \cdot R'(t) \\
%
%\frac{dD(t)}{dt} = {}&  (1 + q)\theta\cdot I(t)
%
%\end{aligned}
%$$
%
%
%\subsection{The final SIR(D) Model}
%The final implementation allows for heterogeneity within the population on infection level, recovery level, as well as relapsation level. Two groups within the population are considered, "normally susceptible" and "highly susceptible" people. Highly susceptibles are destinguished as a linearly transformed version of normal susceptibles. To model lethality impacts and relapsation rates of the different subgroups, the classical $R$ (removed) group was split into a recovered group ($R'$) and a deceased group $D$. 
%
%The final system of differential equations hence looks as follows: 
%
%$$
%\begin{aligned}
%
%\frac{dS(t)}{dt} = &  -\beta(\alpha_n  + k (1 -\alpha_n)) \cdot S(t) \cdot I(t) + \delta(1 + h) \cdot R'(t) \\
%\frac{dI(t)}{dt} = &  \beta(\alpha_n  + k (1 -\alpha_n)) \cdot S(t) \cdot I(t) - (1 + j)\gamma'\cdot I(t) - (1 + q)\theta\cdot I(t) \\
%
%\frac{dR'(t)}{dt} = &  (1 + j)\gamma'\cdot I(t) - \delta(1 + h) \cdot R'(t) \\
%\frac{dD(t)}{dt} = &  (1 + q)\theta\cdot I(t)
%
%\end{aligned}
%$$



